# -*- coding: utf-8 -*-
"""streamlit_app.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1DFjhljPz7onT3DqrRFcTd43hjDhObdnu
"""

!pip install streamlit
import streamlit as st
import pandas as pd
import pickle

st.title("Customer Churn Prediction App")
st.write("Upload a CSV file with customer details to get churn predictions.")

# Load model
pipeline = pickle.load(open("churn_model.pkl", "rb"))
preprocessor = pipeline["preprocessor"]
model = pipeline["model"]

uploaded_file = st.file_uploader("Upload CSV", type=["csv"])

if uploaded_file:
    df = pd.read_csv(uploaded_file)

    st.write("### Uploaded Data")
    st.dataframe(df)

    # Preprocess input data
    X_processed = preprocessor.transform(df)

    # Predict
    predictions = model.predict(X_processed)
    probabilities = model.predict_proba(X_processed)[:, 1]

    # Add results to dataframe
    df["Churn_Prediction"] = predictions
    df["Churn_Probability"] = probabilities

    st.write("### Prediction Results")
    st.dataframe(df)

    # Download button
    csv = df.to_csv(index=False).encode("utf-8")
    st.download_button(
        label="Download Results as CSV",
        data=csv,
        file_name="churn_predictions.csv",
        mime="text/csv",
    )